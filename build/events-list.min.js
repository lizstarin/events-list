/*! events-list 2018-12-03 */
var eventsList=function(){window.onload=function(a){mapboxgl.accessToken="pk.eyJ1IjoibGl6c3RhcmluIiwiYSI6ImNqcDRjbjA0eDBmenIzanA3Znd5MnBvd3gifQ.feWymrUSbwc9izQhA-HqpQ";var b=function(){return new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v10",center:[-95,37],zoom:3.5})},c=function(a){var b=a.filter(function(a){return null!=a.location}),c=[];return b.forEach(function(a){var b={type:"Feature",geometry:{type:"Point",coordinates:[a.location.location.longitude,a.location.location.latitude]},properties:{title:a.title,summary:a.summary,description:a.description,url:a.browser_url,id:a.id}};c.push(b)}),{type:"FeatureCollection",features:c}},d=function(a){a.features.forEach(function(a){var b=document.createElement("div");b.className="marker",b.dataset.id=a.properties.id,new mapboxgl.Marker(b).setLngLat(a.geometry.coordinates).setPopup(new mapboxgl.Popup({offset:25}).setHTML('<a href="'+a.properties.url+'"><h3>'+a.properties.title+"</h3></a><p>"+a.properties.description+"</p>")).addTo(h)})},e=function(a,b){var c=document.createElement("div"),d=document.createTextNode(a);return c.appendChild(d),c.className=b,c},f=function(a){a.forEach(function(a){var b=document.createElement("div");b.className="event-item";var c=document.createElement("a");c.href=a.browser_url;var d=e(a.title,"event-title"),f=e(a.summary,"event-summary");c.appendChild(d),c.appendChild(f),b.appendChild(c),b.dataset.id=a.id,document.getElementById("list").appendChild(b)})},g=function(){fetch("https://events.mobilizeamerica.io/api/v1/events").then(function(a){if(a.ok)return a.json();a.redirect("error.html")}).then(function(a){var b=a.data,e=c(b);d(e),f(b),h.resize()}).catch(function(a){console.log("fetch error: ",a.message),window.location="error.html"})},h=b();g()}}();